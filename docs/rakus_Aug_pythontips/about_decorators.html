
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="../reveal.js/dist/theme/black.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../reveal.js/plugin/highlight/zenburn.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/common.css" />
    <link rel="stylesheet" type="text/css" href="../_static/Font-Awesome/css/all.min.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æ¤œç´¢" href="../search.html" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@ftnext" />
    <meta property="og:url" content="https://ftnext.github.io/2021_slides/rakus_Aug_pythontips/about_decorators.html" />
    <meta property="og:title" content="ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦" />
    <meta property="og:description" content="2021/08 ãƒ©ã‚¯ã‚¹ Python Tips LTä¼š vol.2 ã‚¹ãƒ©ã‚¤ãƒ‰ï¼ˆåˆç‰ˆï¼‰" />

    

  </head><body>
    <div class="reveal">
        <div class="slides">
            <section >
<h1>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h1>
<dl class="field-list simple">
<dt class="field-odd">Event</dt>
<dd class="field-odd"><p>ãƒ©ã‚¯ã‚¹ Python Tips LTä¼š vol.2</p>
</dd>
<dt class="field-even">Presented</dt>
<dd class="field-even"><p>2021/08/05 nikkie</p>
</dd>
</dl>
</section>
<section >
<h2>â“ Questionï¼ˆãƒãƒ£ãƒƒãƒˆãŠé¡˜ã„ã—ã¾ã™ğŸ™ï¼‰</h2>
<p>ãµã ã‚“ <strong>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</strong> ä½¿ã£ã¦ã¾ã™ã‹ï¼Ÿ</p>
<ul class="simple">
<li><p>ã‚¬ãƒƒãƒ„ãƒªğŸ’ª</p></li>
<li><p>ãŸã¾ã«ğŸ˜ƒ</p></li>
<li><p>åˆè€³ï¼ğŸ‘‚</p></li>
</ul>
</section>
<section>
<section >
<h2>ãŠå‰ã€èª°ã‚ˆ</h2>
<ul class="simple">
<li><p>Pythonå¤§å¥½ã <strong>ã«ã£ããƒ¼</strong> ï¼ˆ<span class="raw-html"><i class="fab fa-twitter"></i></span> <a class="reference external" href="https://twitter.com/ftnext">&#64;ftnext</a> / <span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/ftnext">&#64;ftnext</a>ï¼‰</p></li>
<li><p>Pythonæ­´3å¹´åŠã€‚ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆã«ã—ã¦NLPer</p></li>
<li><p><em>Py</em> thon <em>Con</em> ference JP 2021 åº§é•·ğŸ‡¨ğŸ‡­</p></li>
<li><p><strong>tips</strong>: Pythonç•Œéšˆã§ã¯ <em>è‡ªå·±ç´¹ä»‹ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹</em> ãŒã€ŒãŠå‰ã€èª°ã‚ˆã€ï¼ˆ<a class="reference external" href="https://www.ianlewis.org/jp/pycon-mini-jp">ãƒ«ãƒ¼ãƒ„</a>ï¼‰</p></li>
</ul>
</section>
<section >
<h3>ãŠå‰ã€èª°ã‚ˆï¼ˆæ‰¿å‰ï¼‰</h3>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">æˆ‘ãŒåã¯ã«ã£ããƒ¼ã€‚ã‚¢ãƒ‹ãƒ¡å¤§å¥½ãğŸ¥°ã“ã®å¤ã¯ã‚¢ãƒ‹ãƒ¡æ˜ ç”»ãŒã‚¢ãƒ„ã„ï¼ï¼<br>ç«œã¨ãã°ã‹ã™ã®å§«ğŸ‰ã€ã‚µã‚¤ãƒ€ãƒ¼ã®ã‚ˆã†ã«è¨€è‘‰ãŒæ¹§ãä¸ŠãŒã‚‹ğŸ¥¤ã€æ˜ ç”»å¤§å¥½ããƒãƒ³ãƒã•ã‚“ğŸ¦ã€ã‹ãã—ã”ã¨ğŸ‘©â€ğŸ¨ã€ãã‚“ãƒ¢ã‚¶ and so onï¼<br>ã—ã‹ã—ã“ã“æ•°æ—¥éƒ½å†…ã¯æ„ŸæŸ“è€…æ•°3000äººçªç ´ã€‚å¤–å‡ºã—ã¥ã‚‰ã„ã€‚ã‚ã£ã¡ã‚ƒè¦‹ãŸã„ï¼ã‘ã©ãƒªã‚¹ã‚¯ã¨ã‚‹ã‹æ‚©ã‚€ã€‚ããŠãŠãŠğŸ¤¨</p>&mdash; nikkie ğŸ“£PyCon JP 2021 ã‚¹ã‚¿ãƒƒãƒ•å‹Ÿé›†ä¸­ï¼ (@ftnext) <a href="https://twitter.com/ftnext/status/1421319212081942528?ref_src=twsrc%5Etfw">July 31, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></section>
</section>
<section>
<section >
<h2>ä»Šå›ã®ãƒ†ãƒ¼ãƒã¯ã€Œãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã€</h2>
</section>
<section >
<h3>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h3>
<ul class="simple">
<li><p>èªå¼Šã‚’æã‚Œãšã«è¨€ãˆã°ã€ <strong>é–¢æ•°ã‚’è¿”ã™é–¢æ•°</strong></p></li>
<li><p>ã€Œé–¢æ•°ãŒé–¢æ•°ã‚’è¿”ã™ã£ã¦ã©ã†ã„ã†ã“ã¨ï¼Ÿã€ğŸ¤¨</p></li>
<li><p>ğŸ‘‰ é–¢æ•°ã®åŸºæœ¬ã‹ã‚‰è¦‹ã¦ã„ãã¾ã—ã‚‡ã†</p></li>
</ul>
</section>
<section >
<h3>ãŠå“æ›¸ãï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h3>
<ul class="simple">
<li><p>Pythonã®é–¢æ•°</p></li>
<li><p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</p></li>
<li><p>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</p></li>
</ul>
</section>
<section >
<h3>ãŠå“æ›¸ãï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h3>
<ul class="simple">
<li><p><strong>Pythonã®é–¢æ•°</strong></p></li>
<li><p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</p></li>
<li><p>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</p></li>
</ul>
</section>
</section>
<section>
<section >
<h2>Pythonã®é–¢æ•°</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def calculate_bmi(height_m, weight_kg):
    # ref: https://en.wikipedia.org/wiki/Body_mass_index
    return weight_kg / height_m / height_m</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def calculate_bmi(height_m, weight_kg):
...     return weight_kg / height_m / height_m</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; calculate_bmi(1.58, 46)
18.426534209261334</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;skip</span></code> (å¯„ã‚Šé“) é–¢æ•°ã®tips</h3>
<ul class="simple">
<li><p>è¿”ã‚Šå€¤ã¨ã—ã¦è¤‡æ•°ã®å¼ã‚’è¿”ã›ã‚‹ï¼ˆã‚¿ãƒ—ãƒ«ï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">yield</span></code> ã«ã‚ˆã‚‹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼ˆ <a class="reference external" href="https://ftnext.github.io/2021_slides/rakus_Feb_pythontips/about_yield.html">vol.1ã®ã‚¹ãƒ©ã‚¤ãƒ‰</a> å‚ç…§ï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calculate_bmi(height_m=1.58,</span> <span class="pre">weight_kg=46)</span></code> ã¨ã‚‚å‘¼ã³å‡ºã›ã‚‹</p>
<ul>
<li><p>Python 3.8~ ä½ç½®ã®ã¿ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ã¿å¼•æ•°</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section>
<section >
<h2>å„ªå…ˆã‚½ãƒ¼ãƒˆ</h2>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def sort_priority(values, group):
...     def helper(x):
...         if x in group:
...             return (0, x)
...         return (1, x)
...     values.sort(key=helper)</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; values = [1, 4, 3, 5, 2]
&gt;&gt;&gt; # valuesã‚’ç´ æ•°ã‚’å„ªå…ˆã—ã¦ä¸¦ã³æ›¿ãˆï¼ˆç´ æ•°ã®æ˜‡é †ã€æ®‹ã‚Šã®æ˜‡é †ï¼‰
&gt;&gt;&gt; sort_priority(values, {2, 3, 5})
&gt;&gt;&gt; values
[2, 3, 5, 1, 4]
&gt;&gt;&gt; # valuesã‚’å¶æ•°ã‚’å„ªå…ˆã—ã¦ä¸¦ã³æ›¿ãˆï¼ˆç´ æ•°ã®æ˜‡é †ã€æ®‹ã‚Šã®æ˜‡é †ï¼‰
&gt;&gt;&gt; sort_priority(values, {2, 4})
&gt;&gt;&gt; values
[2, 4, 1, 3, 5]</code></pre>
</section>
<section >
<h3>å„ªå…ˆã‚½ãƒ¼ãƒˆå®Ÿè£…ï¼šé–¢æ•°ã®ä¸­ã«é–¢æ•°</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    def helper(x):
        if x in group:
            return (0, x)
        return (1, x)
    values.sort(key=helper)</code></pre>
<p><span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/bslatkin/effectivepython/blob/master/example_code/item_21.py#L50">https://github.com/bslatkin/effectivepython/blob/master/example_code/item_21.py#L50</a></p>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">sort_priority(values,</span> <span class="pre">{2,</span> <span class="pre">3,</span> <span class="pre">5})</span></code></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">values</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">4,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">2]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">helper</span></code> ã®è¿”ã‚Šå€¤</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> ã«ã¤ã„ã¦ã¯ <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">2),</span> <span class="pre">(0,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">5)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">group</span></code> ã«ãªã„ã‚‚ã® <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1),</span> <span class="pre">(1,</span> <span class="pre">4)</span></code></p></li>
</ul>
</li>
<li><p>key: <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1),</span> <span class="pre">(1,</span> <span class="pre">4),</span> <span class="pre">(0,</span> <span class="pre">3),</span> <span class="pre">(0,</span> <span class="pre">5),</span> <span class="pre">(0,</span> <span class="pre">2)</span></code> ã§ä¸¦ã¹æ›¿ãˆãŸ</p></li>
</ul>
</section>
</section>
<section>
<section >
<h2>å„ªå…ˆã‚½ãƒ¼ãƒˆã®ä¾‹ã‹ã‚‰2ç‚¹</h2>
<ul class="simple">
<li><p>ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£</p></li>
<li><p>é–¢æ•°ã¯ã€ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</p></li>
</ul>
</section>
<section >
<h3>(å†æ²)å„ªå…ˆã‚½ãƒ¼ãƒˆå®Ÿè£…</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    def helper(x):  # ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£
        if x in group:
            return (0, x)
        return (1, x)
    values.sort(key=helper)  # ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</code></pre>
</section>
<section >
<h3>ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£</h3>
<ul class="simple">
<li><p><em>functions that refer to variables from the scope in which they were defined</em> ï¼ˆã€Effective Python second editionã€Item 21 p.84ï¼‰</p></li>
<li><p>ï¼è‡ªèº«ãŒå®šç¾©ã•ã‚ŒãŸã‚¹ã‚³ãƒ¼ãƒ—ã‹ã‚‰ï¼ˆå¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—ã®ï¼‰å¤‰æ•°ã‚’å‚ç…§ã™ã‚‹é–¢æ•°ï¼ˆè¨³ã®æ¡ˆï¼‰</p></li>
<li><p>å„ªå…ˆã‚½ãƒ¼ãƒˆã® <code class="docutils literal notranslate"><span class="pre">helper</span></code> é–¢æ•°</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort_priority</span></code> ã®å¼•æ•° <code class="docutils literal notranslate"><span class="pre">group</span></code> ã‚’ <strong>å‚ç…§</strong> ã—ã¦ã„ã‚‹</p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h3>
<ul class="simple">
<li><p>é–¢æ•°ã‚’ <em>ã€Œç›´æ¥å‚ç…§ã§ãã€å¤‰æ•°ã«ä»£å…¥ã—ãŸã‚Šã€ä»–ã®é–¢æ•°ã®å¼•æ•°ã¨ã—ã¦æ¸¡ã—ãŸã‚Šã€å¼ã®ä¸­ã‚„ifæ–‡ã®ä¸­ã§æ¯”è¼ƒã€</em> ã§ãã‚‹ï¼ˆã€Effective Python ç¬¬2ç‰ˆã€é …ç›®21 p.80ï¼‰</p></li>
<li><p>å„ªå…ˆã‚½ãƒ¼ãƒˆã® <code class="docutils literal notranslate"><span class="pre">values.sort(key=helper)</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">sort</span></code> ãƒ¡ã‚½ãƒƒãƒ‰ã® <code class="docutils literal notranslate"><span class="pre">key</span></code> <strong>å¼•æ•°ã«é–¢æ•°ã‚’æ¸¡ã—</strong> ã¦ã„ã‚‹</p></li>
</ul>
</li>
</ul>
</section>
</section>
<section>
<section >
<h2>é–¢æ•°ã‚’è¿”ã™é–¢æ•°</h2>
<ul class="simple">
<li><p>é–¢æ•°ãŒãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚‹ã“ã¨ã¨ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ã‚’åˆ©ç”¨ã™ã‚‹</p></li>
<li><p>ä¾‹ï¼šç‰¹å®šã®äººã®BMI</p></li>
<li><p>ä½“é‡ã®å¢—æ¸›ã«èˆˆå‘³ï¼ˆèº«é•·ã¯å¤§ããå¤‰ã‚ã‚‰ãªã„ï¼‰</p></li>
</ul>
</section>
<section >
<h3>ä¾‹ï¼šã‚ã‚‹èº«é•·ã®äººã®BMIã‚’ç®—å‡ºã™ã‚‹é–¢æ•°ã‚’è¿”ã™</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def bmi_calculator_with_height(height_m):
    def calculate_bmi_wrapper(weight_kg):
        return weight_kg / height_m / height_m
    return calculate_bmi_wrapper</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def bmi_calculator_with_height(height_m):
...     def calculate_bmi_wrapper(weight_kg):
...         return weight_kg / height_m / height_m
...     return calculate_bmi_wrapper</aside>
</section>
<section >
<h3>ã‚ã‚‹èº«é•·ã®äººã®BMIã®å¤‰åŒ–ã‚’æ±‚ã‚ã‚‹</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; calculate_her_bmi = bmi_calculator_with_height(1.58)
&gt;&gt;&gt; calculate_her_bmi(46)
18.426534209261334
&gt;&gt;&gt; calculate_her_bmi(42)
16.824226886716872
&gt;&gt;&gt; calculate_her_bmi(50)
20.0288415318058</code></pre>
</section>
</section>
<section>
<section >
<h2>ğŸ¥Ÿå°ã¾ã¨ã‚ï¼šPythonã®é–¢æ•°</h2>
<ul class="simple">
<li><p>é–¢æ•°ã®ä¸­ã«é–¢æ•°ã‚’æ›¸ãä¾‹ã‚’è¦‹ã¦ããŸ</p></li>
<li><p>ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼šå†…å´ã®é–¢æ•°ã‹ã‚‰å¤–å´ã®é–¢æ•°ã®å¼•æ•°ã‚’ <strong>å‚ç…§</strong> ã§ãã‚‹</p></li>
<li><p>ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼šå†…å´ã®é–¢æ•°ã‚’å¤–å´ã®é–¢æ•°ã® <strong>è¿”ã‚Šå€¤</strong> ã«ã§ãã‚‹</p></li>
</ul>
</section>
<section >
<h3>ãŠå“æ›¸ãï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h3>
<ul class="simple">
<li><p>Pythonã®é–¢æ•°</p></li>
<li><p><strong>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</strong></p></li>
<li><p>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</p></li>
</ul>
</section>
</section>
<section>
<section >
<h2>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ï¼ˆç”¨èªé›†ï¼‰</h2>
<blockquote>
<div><p>åˆ¥ã®é–¢æ•°ã‚’è¿”ã™é–¢æ•°ã§ã€é€šå¸¸ã€ &#64;wrapper æ§‹æ–‡ã§é–¢æ•°å¤‰æ›ã¨ã—ã¦é©ç”¨ã•ã‚Œã¾ã™</p>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/ja/3/glossary.html#term-decorator">https://docs.python.org/ja/3/glossary.html#term-decorator</a></p>
</section>
<section >
<h3>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä¾‹ï¼ˆDjangoï¼‰</h3>
<pre><code data-trim data-noescape  class="python">
from django.contrib.auth.decorators import login_required

&#64;login_required
def post_new(request):  # ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã€ãƒ­ã‚°ã‚¤ãƒ³å¿…é ˆã«ã§ãã‚‹
    ...</code></pre>
<p><a class="reference external" href="https://tutorial-extensions.djangogirls.org/ja/authentication_authorization#nono">https://tutorial-extensions.djangogirls.org/ja/authentication_authorization#nono</a></p>
</section>
<section >
<h3>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h3>
<ul class="simple">
<li><p><em>ã€Œãƒ©ãƒƒãƒ—ã™ã‚‹é–¢æ•°ã¸ã®å‘¼ã³å‡ºã—ã®å‰å¾Œã§è¿½åŠ ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€</em> ï¼ˆã€Effective Python ç¬¬2ç‰ˆã€é …ç›®26 p.97ï¼‰</p></li>
<li><p>Djangoã® <code class="docutils literal notranslate"><span class="pre">login_required</span></code> ã¯ <code class="docutils literal notranslate"><span class="pre">post_new</span></code> é–¢æ•°ã®å‰ã«ã€ãƒ­ã‚°ã‚¤ãƒ³ã‚’æ¤œè¨¼ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ãŸ</p></li>
</ul>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;</span></code> ã¯ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚·ãƒ¥ã‚¬ãƒ¼</h3>
<p>ä»¥ä¸‹ã®2ã¤ã¯åŒã˜</p>
<pre><code data-trim data-noescape  class="python">
def f(...):
    ...

f = awesome_decorator(f)</code></pre>
<pre><code data-trim data-noescape  class="python">
&#64;awesome_decorator
def f(...):
    ...</code></pre>
</section>
</section>
<section>
<section >
<h2>ç°¡å˜ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã£ã¦ã¿ã‚‹</h2>
<ul class="simple">
<li><p>ãƒ©ãƒƒãƒ—ã™ã‚‹é–¢æ•°ã« <strong>è¿½åŠ </strong> ã™ã‚‹ã‚³ãƒ¼ãƒ‰</p>
<ul>
<li><p>å®Ÿè¡Œå‰ã«é–‹å§‹ã™ã‚‹æ—¨ã‚’å‡ºåŠ›</p></li>
<li><p>å®Ÿè¡Œå¾Œã«çµ‚äº†ã™ã‚‹æ—¨ã‚’å‡ºåŠ›</p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>é–¢æ•°ã®é–‹å§‹ã¨çµ‚äº†ã‚’ç¤ºã™ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def show_start_end(func):
    def wrapper(*args, **kwargs):
        print(func.__name__, &quot;Start&quot;)
        returned = func(*args, **kwargs)
        print(func.__name__, &quot;End&quot;)
        return returned
    return wrapper</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def show_start_end(func):
...     def wrapper(*args, **kwargs):
...         print(func.__name__, &quot;Start&quot;)
...         returned = func(*args, **kwargs)
...         print(func.__name__, &quot;End&quot;)
...         return returned
...     return wrapper</aside>
</section>
<section >
<h3>é–¢æ•°ã®é–‹å§‹ã¨çµ‚äº†ã‚’ç¤ºã™ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã†</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
&#64;show_start_end
def calculate_bmi(height_m, weight_kg):
    return weight_kg / height_m / height_m</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; &#64;show_start_end
... def calculate_bmi(height_m, weight_kg):
...     return weight_kg / height_m / height_m</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; calculate_bmi(1.58, 46)
calculate_bmi Start
calculate_bmi End
18.426534209261334</code></pre>
</section>
</section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">*args</span></code> ? <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> ?</h2>
<p>2ã¤ã®ã‚·ãƒ¼ãƒ³ã§ä½¿ã†</p>
<ul class="simple">
<li><p>é–¢æ•°å®šç¾©</p></li>
<li><p>é–¢æ•°å‘¼ã³å‡ºã—</p></li>
</ul>
</section>
<section>
<section >
<h2>é–¢æ•°å®šç¾©ã® <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*args</span></code>ï¼šå¯å¤‰å€‹ã® <strong>ä½ç½®</strong> å¼•æ•°</p>
<ul>
<li><p>é–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã§ã¯ <code class="docutils literal notranslate"><span class="pre">args</span></code> ã¯ <strong>ã‚¿ãƒ—ãƒ«</strong></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>ï¼šå¯å¤‰å€‹ã® <strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</strong> å¼•æ•°</p>
<ul>
<li><p>é–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—ã§ã¯ <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> ã¯ <strong>è¾æ›¸</strong></p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>ä¾‹ï¼šé–¢æ•°å®šç¾©ã® <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def f(*args, **kwargs):
    print(args)
    print(kwargs)</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def f(*args, **kwargs):
...     print(args)
...     print(kwargs)</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; f(1, 2, c=3)
(1, 2)
{'c': 3}</code></pre>
</section>
<section >
<h3>ä¾‹ï¼šé–¢æ•°å®šç¾©ã® <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> å®Ÿè¡Œä¾‹</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; # ä½ç½®å¼•æ•°ã®ã¿æ¸¡ã—ãŸæ™‚ã€kwargsã¯ç©ºã®è¾æ›¸
&gt;&gt;&gt; f(1, 2, 3)
(1, 2, 3)
{}
&gt;&gt;&gt; # ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã®ã¿æ¸¡ã—ãŸæ™‚ã€argsã¯ç©ºã®ã‚¿ãƒ—ãƒ«
&gt;&gt;&gt; f(a=1, b=2, c=3)
()
{'a': 1, 'b': 2, 'c': 3}</code></pre>
</section>
</section>
<section>
<section >
<h2>é–¢æ•°å‘¼ã³å‡ºã—ã® <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></h2>
<ul class="simple">
<li><p>ã‚¿ãƒ—ãƒ«ã‚„ãƒªã‚¹ãƒˆãªã© <strong>ã‚·ãƒ¼ã‚±ãƒ³ã‚¹</strong> ã¯ <code class="docutils literal notranslate"><span class="pre">*</span></code> æ¼”ç®—å­ã§ã€è¦ç´ ã‚’ä½ç½®å¼•æ•°ã«æ¸¡ã›ã‚‹</p></li>
<li><p>è¾æ›¸ãªã© <strong>ãƒãƒƒãƒ”ãƒ³ã‚°</strong> ã¯ <code class="docutils literal notranslate"><span class="pre">**</span></code> æ¼”ç®—å­ã§ã€<code class="docutils literal notranslate"><span class="pre">ã‚­ãƒ¼=å€¤</span></code> å½¢å¼ã§å„è¦ç´ ã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã«æ¸¡ã›ã‚‹</p></li>
</ul>
</section>
<section >
<h3>ä¾‹ï¼šé–¢æ•°å‘¼ã³å‡ºã—ã® <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> å®Ÿè¡Œä¾‹</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; # ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ * ã‚’ä½¿ã£ã¦æ¸¡ã™ï¼ˆargsãŒã‚¿ãƒ—ãƒ«ã¨ã—ã¦å—ã‘å–ã‚‹ï¼‰
&gt;&gt;&gt; f(*[1,2,3])
(1, 2, 3)
{}
&gt;&gt;&gt; # ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ ** ã‚’ä½¿ã£ã¦æ¸¡ã™ï¼ˆkwargsãŒè¾æ›¸ã¨ã—ã¦å—ã‘å–ã‚‹ï¼‰
&gt;&gt;&gt; f(**{&quot;a&quot;: 1, &quot;b&quot;: 2, &quot;c&quot;: 3})
()
{'a': 1, 'b': 2, 'c': 3}</code></pre>
</section>
<section >
<h3>å†æ²ï¼šé–¢æ•°ã®é–‹å§‹ã¨çµ‚äº†ã‚’ç¤ºã™ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def show_start_end(func):
    def wrapper(*args, **kwargs):
        print(func.__name__, &quot;Start&quot;)
        # wrapper ã«æ¸¡ã•ã‚ŒãŸä½ç½®å¼•æ•°ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã¯funcã«æ¸¡ã•ã‚Œã‚‹ã¨ã„ã†ã“ã¨
        returned = func(*args, **kwargs)
        print(func.__name__, &quot;End&quot;)
        return returned
    return wrapper</code></pre>
</section>
</section>
<section>
<section >
<h2>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚‹ã¨ãã®tips</h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">awesome_decorator(f)</span></code> ã¨ã„ã†ä»£å…¥ã®è½ã¨ã—ç©´</p></li>
</ul>
</section>
<section >
<h3>è½ã¨ã—ç©´ğŸ˜±</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
&#64;show_start_end
def fully_documented_bmi(height_m, weight_kg):
    &quot;&quot;&quot;Calculate BMI (body mass index).&quot;&quot;&quot;
    return weight_kg / height_m / height_m</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; &#64;show_start_end
... def fully_documented_bmi(height_m, weight_kg):
...     &quot;&quot;&quot;Calculate BMI (body mass index).&quot;&quot;&quot;
...     return weight_kg / height_m / height_m</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; fully_documented_bmi.__name__  # show_start_endãŒè¿”ã™é–¢æ•°ã®å
'wrapper'
&gt;&gt;&gt; print(fully_documented_bmi.__doc__)  # å¤±ã‚ã‚ŒãŸdocstring
None</code></pre>
</section>
<section >
<h3>ğŸ’¡è§£æ±ºç­–ï¼š <code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code></h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
from functools import wraps

def show_start_end(func):
    &#64;wraps(func)  # wrapperã‚’ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã™ã‚‹
    def wrapper(*args, **kwargs):
        print(func.__name__, &quot;Start&quot;)
        returned = func(*args, **kwargs)
        print(func.__name__, &quot;End&quot;)
        return returned
    return wrapper</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; from functools import wraps
&gt;&gt;&gt; def show_start_end(func):
...     &#64;wraps(func)
...     def wrapper(*args, **kwargs):
...         print(func.__name__, &quot;Start&quot;)
...         returned = func(*args, **kwargs)
...         print(func.__name__, &quot;End&quot;)
...         return returned
...     return wrapper</aside>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code> ã§è½ã¨ã—ç©´å›é¿ğŸ™Œ</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
&#64;show_start_end
def fully_documented_bmi(height_m, weight_kg):
    &quot;&quot;&quot;Calculate BMI (body mass index).&quot;&quot;&quot;
    return weight_kg / height_m / height_m</code></pre>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; &#64;show_start_end
... def fully_documented_bmi(height_m, weight_kg):
...     &quot;&quot;&quot;Calculate BMI (body mass index).&quot;&quot;&quot;
...     return weight_kg / height_m / height_m</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; fully_documented_bmi.__name__  # ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä»˜ã‘ãŸé–¢æ•°è‡ªä½“ã®åï¼
'fully_documented_bmi'
&gt;&gt;&gt; print(fully_documented_bmi.__doc__)  # docstringãŒå¤±ã‚ã‚Œã¦ã„ãªã„ï¼
Calculate BMI (body mass index).</code></pre>
</section>
</section>
<section >
<h2>ğŸ¥Ÿå°ã¾ã¨ã‚ï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h2>
<ul class="simple">
<li><p>é–¢æ•°ã®å‘¼ã³å‡ºã—å‰å¾Œã«å‡¦ç†ã‚’è¿½åŠ ã§ãã‚‹</p></li>
<li><p><strong>é–¢æ•°ã‚’è¿”ã™é–¢æ•°</strong> ã¨ã—ã¦å®Ÿè£…</p></li>
<li><p>é–¢æ•°å®šç¾©ã¨é–¢æ•°å‘¼ã³å‡ºã—ã§ <code class="docutils literal notranslate"><span class="pre">*args</span></code>ãƒ» <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> ã‚’ä½¿ã†</p></li>
<li><p>ãƒ¯ãƒ³ãƒã‚¤ãƒ³ãƒˆï¼š <code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code></p></li>
</ul>
</section>
<section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">&#64;skip</span></code> ï¼ˆæ™‚é–“ãŒã‚ã‚Œã°ï¼‰ç§ãŒè»Šè¼ªã®å†å®Ÿè£…ã—ãŸãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def cache_enabled(func):
    cache = {}

    &#64;functools.wraps(func)
    def wrapper(*args, **kwargs):
        key = kwargs[&quot;number&quot;]
        if key in cache:
            return cache[key]
        retval = func(*args, **kwargs)
        cache[key] = retval
        return retval

    return wrapper
</code></pre>
</section>
<section >
<h3>ãŠå“æ›¸ãï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h3>
<ul class="simple">
<li><p>Pythonã®é–¢æ•°</p></li>
<li><p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</p></li>
<li><p><strong>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</strong></p></li>
</ul>
</section>
</section>
<section >
<h2>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</h2>
<ul class="simple">
<li><p>å‚ç…§ã¨ä»£å…¥ãã‚Œãã‚Œã®ã‚¹ã‚³ãƒ¼ãƒ—ã®æ‰±ã„</p></li>
<li><p>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</p></li>
</ul>
</section>
<section>
<section >
<h2>ä¾‹ï¼šå„ªå…ˆã—ãŸã‹ã©ã†ã‹ã‚’è¿”ã™å„ªå…ˆã‚½ãƒ¼ãƒˆ</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    found = False
    def helper(x):
        if x in group:
            found = True
            return (0, x)
        return (1, x)
    values.sort(key=helper)
    return found</code></pre>
<p><span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/bslatkin/effectivepython/blob/master/example_code/item_21.py#L65">https://github.com/bslatkin/effectivepython/blob/master/example_code/item_21.py#L65</a></p>
</section>
<section >
<h3>å„ªå…ˆã—ãŸã‹ã‚’è¿”ã—ã¦ã„ãªã„ï¼ŸğŸ¤¨</h3>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def sort_priority(values, group):
...     found = False
...     def helper(x):
...         if x in group:
...             found = True
...             return (0, x)
...         return (1, x)
...     values.sort(key=helper)
...     return found</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; values = [1, 4, 3, 5, 2]
&gt;&gt;&gt; # valuesã‚’ç´ æ•°ã‚’å„ªå…ˆã—ã¦ä¸¦ã³æ›¿ãˆã¦ã„ã‚‹ãŒã€è¿”ã‚Šå€¤ã¯False
&gt;&gt;&gt; sort_priority(values, {2, 3, 5})
False
&gt;&gt;&gt; values
[2, 3, 5, 1, 4]</code></pre>
</section>
<section >
<h3>ãªãœå„ªå…ˆã—ãŸã‹ã‚’è¿”ã•ãªã„ï¼Ÿ</h3>
<ul class="simple">
<li><p>å¤‰æ•°ã®å‚ç…§ã®ã‚¹ã‚³ãƒ¼ãƒ—è§£æ±ºé †</p></li>
<li><p>ä»£å…¥ã®ã‚¹ã‚³ãƒ¼ãƒ—è§£æ±º</p></li>
</ul>
</section>
</section>
<section>
<section >
<h2>å¤‰æ•°ã®å‚ç…§ã®ã‚¹ã‚³ãƒ¼ãƒ—è§£æ±ºé †</h2>
<ol class="arabic simple">
<li><p>ç¾åœ¨ã®é–¢æ•°ã®ã‚¹ã‚³ãƒ¼ãƒ—</p></li>
<li><p>ï¼ˆä»–ã®é–¢æ•°ã®ä¸­ã«ã‚ã‚‹å ´åˆï¼‰å¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—</p></li>
<li><p>ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰</p></li>
<li><p>çµ„ã¿è¾¼ã¿ã‚¹ã‚³ãƒ¼ãƒ—</p></li>
</ol>
<p>ã€Effective Python ç¬¬2ç‰ˆã€p.81</p>
</section>
<section >
<h3>ä¾‹ï¼šã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ <code class="docutils literal notranslate"><span class="pre">helper</span></code> ã® <code class="docutils literal notranslate"><span class="pre">group</span></code></h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    found = False
    def helper(x):
        if x in group:  # å¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—ã®groupã‚’å‚ç…§
            found = True
            return (0, x)
        return (1, x)
    values.sort(key=helper)
    return found</code></pre>
</section>
</section>
<section>
<section >
<h2>ä»£å…¥ã®ã‚¹ã‚³ãƒ¼ãƒ—è§£æ±º</h2>
<blockquote>
<div><p>å¤‰æ•°ãŒç¾åœ¨ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«å­˜åœ¨ã—ãªã„ã¨ã€Pythonã¯ã€ä»£å…¥ã‚’å¤‰æ•°å®šç¾©ã®ã‚ˆã†ã«æ‰±ã„ã¾ã™</p>
</div></blockquote>
<p>ã€Effective Python ç¬¬2ç‰ˆã€p.81</p>
</section>
<section >
<h3>ãªãœå„ªå…ˆã—ãŸã‹ã‚’è¿”ã•ãªã‹ã£ãŸã‹ï¼Ÿ</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    found = False
    def helper(x):
        if x in group:
            # ä»¥ä¸‹ã¯helperã®ã‚¹ã‚³ãƒ¼ãƒ—ã§å¤‰æ•°foundã‚’å®šç¾©
            found = True  # 2è¡Œç›®ã®foundã¨ã¯ç„¡é–¢ä¿‚
            return (0, x)
        return (1, x)
    values.sort(key=helper)
    return found  # sort_priorityã®ã‚¹ã‚³ãƒ¼ãƒ—ã®found</code></pre>
</section>
</section>
<section>
<section >
<h2>ğŸ’¡è§£æ±ºç­–ï¼š <code class="docutils literal notranslate"><span class="pre">nonlocal</span></code> æ–‡</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def sort_priority(values, group):
    found = False
    def helper(x):
        nonlocal found  # sort_priorityã®found
        if x in group:
            found = True  # helperã®ã‚¹ã‚³ãƒ¼ãƒ—ã‹ã‚‰ä»£å…¥ã§ãã‚‹ï¼ï¼ˆnonlocalã®åŠ¹æœï¼‰
            return (0, x)
        return (1, x)
    values.sort(key=helper)
    return found</code></pre>
</section>
<section >
<h3>å„ªå…ˆã—ãŸã‹ã‚’è¿”ã™ã‚ˆã†ã«ï¼ğŸ™Œ</h3>
<aside class="notes">
doctest ã‚’é€šã™
&gt;&gt;&gt; def sort_priority(values, group):
...     found = False
...     def helper(x):
...         nonlocal found
...         if x in group:
...             found = True
...             return (0, x)
...         return (1, x)
...     values.sort(key=helper)
...     return found</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; values = [1, 4, 3, 5, 2]
&gt;&gt;&gt; sort_priority(values, {2, 3, 5})
True
&gt;&gt;&gt; values
[2, 3, 5, 1, 4]</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">nonlocal</span></code> ã‚’ä½¿ã£ãŸãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ï¼šå‘¼ã³å‡ºã—ã¯1åˆ†ã«1å›</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
def once_per_minute(func):
    last_ran_at = 0

    &#64;wraps(func)
    def wrapper(*args, **kwargs):
        nonlocal last_ran_at
        current_time = time.time()
        if current_time - last_ran_at &lt; 60:
            raise RunTooOftenError(
                f&quot;Wait longer before running {func.__name__}&quot;
            )
        last_ran_at = current_time
        value = func(*args, **kwargs)
        return value

    return wrapper
</code></pre>
</section>
<section >
<h3>ã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</h3>
<ul class="simple">
<li><p>å‚ç…§ã¨ä»£å…¥ãã‚Œãã‚Œã®ã‚¹ã‚³ãƒ¼ãƒ—ã®æ‰±ã„</p></li>
<li><p><strong>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</strong></p></li>
</ul>
</section>
</section>
<section>
<section >
<h2>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä¾‹ï¼ˆFastAPIï¼‰</h2>
<pre><code data-trim data-noescape  class="python">
&#64;app.get(&quot;/&quot;)
async def root():
    return {&quot;message&quot;: &quot;Hello World&quot;}</code></pre>
<p><a class="reference external" href="https://fastapi.tiangolo.com/ja/tutorial/first-steps/">https://fastapi.tiangolo.com/ja/tutorial/first-steps/</a></p>
</section>
<section >
<h3>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†æ›¸ãï¼Ÿ</h3>
<ul class="simple">
<li><p><strong>3ã¤ã®é–¢æ•°</strong> ã§å®Ÿè£…ã™ã‚‹</p></li>
</ul>
<pre><code data-trim data-noescape  class="python">
def decorator_with_args(x, y):  # å¼•æ•°ã‚’å—ã‘å–ã‚Šmiddleã‚’è¿”ã™
    def middle(func):  # é–¢æ•°ã‚’å—ã‘å–ã‚Šwrapperã‚’è¿”ã™
        def wrapper(*args, **kwargs):
            ...
        return wrapper
    return middle</code></pre>
</section>
</section>
<section>
<section >
<h2>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ï¼šå‘¼ã³å‡ºã—ã¯Nåˆ†ã«1å›</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def once_per_n_minutes(n):
    def middle(func):
        last_ran_at = 0

        &#64;wraps(func)
        def wrapper(*args, **kwargs):
            nonlocal last_ran_at
            current_time = time.time()
            if current_time - last_ran_at &lt; n * 60:
                raise RunTooOftenError(
                    f&quot;Wait longer before running {func.__name__}&quot;
                )
            last_ran_at = current_time
            value = func(*args, **kwargs)
            return value

        return wrapper

    return middle
</code></pre>
</section>
<section >
<h3>å¼•æ•°ã‚’æ¸¡ã—ã¦ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆ</h3>
<pre><code data-trim data-noescape data-line-numbers class="python">
&#64;once_per_n_minutes(0)
def calculate_bmi2(height_m, weight_kg):
    return calculate_bmi(height_m, weight_kg)
</code></pre>
<pre><code data-trim data-noescape data-line-numbers class="python">
&#64;once_per_n_minutes(n=3)
def calculate_bmi3(height_m, weight_kg):
    return calculate_bmi(height_m, weight_kg)
</code></pre>
</section>
<section >
<h3>å¼•æ•°ã‚’æ¸¡ã—ã¦ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆ å®Ÿè¡Œä¾‹</h3>
<aside class="notes">
doctest ã‚’é€šã™ï¼ˆãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯é™¤ã„ãŸå®Ÿè£…ï¼‰
&gt;&gt;&gt; def calculate_bmi2(height_m, weight_kg):
...     return weight_kg / height_m / height_m
&gt;&gt;&gt; def calculate_bmi3(height_m, weight_kg):
...     return weight_kg / height_m / height_m</aside>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; calculate_bmi2(1.58, 46)
18.426534209261334
&gt;&gt;&gt; calculate_bmi2(1.58, 46)
18.426534209261334
&gt;&gt;&gt; calculate_bmi3(1.58, 46)
18.426534209261334
&gt;&gt;&gt; # calculate_bmi3(1.58, 46)  # Raise RunTooOftenError</code></pre>
</section>
</section>
<section >
<h2>ğŸ¥Ÿå°ã¾ã¨ã‚ï¼šã‚ˆã‚Šä¾¿åˆ©ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ããŸã‚ã«</h2>
<ul class="simple">
<li><p>å¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—ã®å¤‰æ•°ã€å‚ç…§ã§ãã‚‹ãŒã€ <strong>ä»£å…¥</strong> ã«ã¯ <code class="docutils literal notranslate"><span class="pre">nonlocal</span></code> æ–‡</p></li>
<li><p>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã€ <strong>3ã¤</strong> ã®é–¢æ•°ã§å®Ÿè£…</p></li>
</ul>
</section>
<section>
<section >
<h2>ğŸŒ¯ã¾ã¨ã‚ï¼šãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦</h2>
<ul class="simple">
<li><p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ï¼é–¢æ•°ã‚’è¿”ã™é–¢æ•°ã€‚ <strong>å‡¦ç†ã‚’è¿½åŠ </strong> ã§ãã‚‹</p></li>
<li><p>å®Ÿè£…ã®éµã¯ã€ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãƒ» <code class="docutils literal notranslate"><span class="pre">*args,</span> <span class="pre">**kwargs</span></code> ãƒ» <code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nonlocal</span></code> ã‚„å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã§ã‚ˆã‚Šé«˜æ©Ÿèƒ½ã«ï¼</p></li>
</ul>
</section>
<section >
<h3>ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</h3>
<p><strong>Enjoy</strong> development with decorators!</p>
<p>Referencesã€<strong>Appendix</strong> ãŒç¶šãã¾ã™ï¼ˆã‚ˆã‚ã—ã‘ã‚Œã°ã©ã†ãï¼ï¼‰</p>
</section>
</section>
<section>
<section >
<h2>References 1/2</h2>
<ul class="simple">
<li><p>ã€<a class="reference external" href="https://www.oreilly.co.jp/books/9784873119175/">Effective Python ç¬¬2ç‰ˆ</a>ã€3ç« é–¢æ•°ï¼ˆç‰¹ã«ä»¥ä¸‹ï¼‰</p>
<ul>
<li><p>é …ç›®21 ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ãŒå¤‰æ•°ã‚¹ã‚³ãƒ¼ãƒ—ã¨ã©ã†é–¢ã‚ã‚‹ã‹ã‚’æŠŠæ¡ã—ã¦ãŠã</p></li>
<li><p>é …ç›®22 å¯å¤‰é•·ä½ç½®å¼•æ•°ã‚’ä½¿ã£ã¦ã€è¦‹ãŸç›®ã‚’ã™ã£ãã‚Šã•ã›ã‚‹</p></li>
<li><p>é …ç›®26 functools.wrapsã‚’ä½¿ã£ã¦é–¢æ•°ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹</p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>References 2/2</h3>
<ul class="simple">
<li><p>The Global Dev Study #4 - FastAPI / Python</p>
<ul>
<li><p><a class="reference external" href="https://youtu.be/Ly3ZUDqAsL8">YouTube</a></p></li>
<li><p><a class="reference external" href="https://github.com/reuven/Forkwell-2021-July-6">Source code</a></p></li>
</ul>
</li>
<li><p>PyCon JP 2020 ã€Œ<a class="reference external" href="https://pycon.jp/2020/timetable/?id=203944">è©³è§£ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</a>ã€</p></li>
</ul>
</section>
</section>
<section >
<h2>Appendix ä½œæˆä¸­</h2>
</section>
<section >
<h2>EOF</h2>
</section>

        </div>
    </div>
    
    <script src="../reveal.js/dist/reveal.js"></script>
    
    
      <script src="../reveal.js/plugin/highlight/highlight.js"></script>
      
    
    <script>
        var revealjsConfig = new Object();
        Object.assign(revealjsConfig, 
    {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: "none",
        slideNumber: "c/t",
    }
);
        
        
        
          revealjsConfig.plugins = [
            RevealHighlight,
          ];
        
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize(revealjsConfig);
    </script>

  </body>
</html>
