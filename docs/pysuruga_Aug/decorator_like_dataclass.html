
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>@dataclass ã®ã‚ˆã†ãªã€ () ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†ä½œã‚‹ï¼Ÿ</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../reveal.js/dist/reveal.css" />
    <link rel="stylesheet" href="../reveal.js/dist/theme/black.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../reveal.js/plugin/highlight/zenburn.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/common.css" />
    <link rel="stylesheet" type="text/css" href="../_static/Font-Awesome/css/all.min.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="ç´¢å¼•" href="../genindex.html" />
    <link rel="search" title="æ¤œç´¢" href="../search.html" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ftnext">
    <meta property="og:url" content="https://ftnext.github.io/2021_slides/pysuruga_Aug/decorator_like_dataclass.html">
    <meta property="og:title" content="@dataclass ã®ã‚ˆã†ãªã€ () ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†ä½œã‚‹ï¼Ÿ">
    <meta property="og:description" content="2021/08 Pythoné§¿æ²³ å‹‰å¼·ä¼š #28 ï½çœŸå¤ã®LTå¤§ä¼šï½ ã‚¹ãƒ©ã‚¤ãƒ‰">
    <meta property="og:image" content="https://ftnext.github.io/2021_slides/_images/ogps/pysuruga_Aug.png">



  </head><body>
    <div class="reveal">
        <div class="slides">
            <section >
<h1><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªã€ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†ä½œã‚‹ï¼Ÿ</h1>
</section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªã€ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†ä½œã‚‹ï¼Ÿ</h2>
<dl class="field-list simple">
<dt class="field-odd">Event</dt>
<dd class="field-odd"><p>Pythoné§¿æ²³ å‹‰å¼·ä¼š #28</p>
</dd>
<dt class="field-even">Presented</dt>
<dd class="field-even"><p>2021/08/28 nikkie</p>
</dd>
</dl>
</section>
<section>
<section >
<h2>11æœˆ #pycon_shizu é–‹å‚¬ğŸ‰ æ¥½ã—ã¿ã§ã™ã­</h2>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ãŠä¹…ã—ã¶ã‚Šã§ã™ã€‚å®Ÿè¡Œå§”å“¡ä¼šã§ã™ã€‚<br>ä»Šå¹´ã‚‚ PyCon mini Shizuoka 2021ã‚’é–‹å‚¬ã™ã‚‹ã“ã¨ãŒæ±ºå®šã—ã¾ã—ãŸğŸ‰<br>é–‹å‚¬æ—¥ã¯ 2021/11/20ï¼ˆåœŸï¼‰ã§ã™ã€‚</p>&mdash; PyCon Mini Shizuoka (@PyconShizu) <a href="https://twitter.com/PyconShizu/status/1430168021436231680?ref_src=twsrc%5Etfw">August 24, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></section>
<section >
<h3>ãŠå‰ã€èª°ã‚ˆ</h3>
<ul class="simple">
<li><p>Pythonå¤§å¥½ã <strong>ã«ã£ããƒ¼</strong> ï¼ˆ<span class="raw-html"><i class="fab fa-twitter"></i></span> <a class="reference external" href="https://twitter.com/ftnext">&#64;ftnext</a> / <span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/ftnext">&#64;ftnext</a>ï¼‰</p></li>
<li><p>Pythonæ­´3å¹´åŠã€‚æ ªå¼ä¼šç¤¾ãƒ¦ãƒ¼ã‚¶ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ãƒ†ã‚£ã‚¹ãƒˆï¼ˆNLPerï¼‰</p></li>
<li><p>ã‚¢ãƒ‹ãƒ¡ã‚‚å¤§å¥½ãï¼ˆğŸŒŸğŸ’«ğŸ™ğŸ’«ğŸŒŸã€€ğŸŒ²ğŸŒ³ğŸ²ã€€2ï¸âƒ£0ï¸âƒ£0ï¸âƒ£6ï¸âƒ£â™»ï¸ï¼‰</p></li>
</ul>
</section>
<section >
<h3>ãŠå‰ã€èª°ã‚ˆï¼šPyCon JP 2021 åº§é•·ğŸ‡¨ğŸ‡­</h3>
<iframe width="640" height="480" src="https://2021.pycon.jp/" title="PyCon JP 2021 Webã‚µã‚¤ãƒˆ"></iframe></section>
<section >
<h3>PyCon JP 2021ã€ãƒã‚±ãƒƒãƒˆç™ºå£²é–‹å§‹ã§ã™ï¼ğŸ«ğŸ™</h3>
<p><a class="reference external" href="https://pyconjp.connpass.com/event/221241/">https://pyconjp.connpass.com/event/221241/</a></p>
</section>
</section>
<section>
<section >
<h2>LTæœ¬é¡Œï¼š <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªã€ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚ŠãŸã„</h2>
</section>
<section >
<h3><a class="reference external" href="https://docs.python.org/ja/3/library/dataclasses.html#dataclasses.dataclass">ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a> ã‚ˆã‚Šã€ä»¥ä¸‹ã®3ã¤ã¯åŒç­‰</h3>
<pre><code data-trim data-noescape  class="python">
&#64;dataclass  # ()ã‚’ä»˜ã‘ãªã„
class C:
    ...

&#64;dataclass()  # ()ã‚’ä»˜ã‘ã‚‹
class C:
    ...

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®å€¤ã§å„å¼•æ•°ã‚’æŒ‡å®š
&#64;dataclass(init=True, repr=True, eq=True, order=False, unsafe_hash=False, frozen=False)
class C:
    ...</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®è¦ä»¶</h3>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;decorator</span></code> ã¨ <code class="docutils literal notranslate"><span class="pre">&#64;decorator()</span></code> ãŒ <strong>åŒã˜</strong></p></li>
<li><p>ãã®ä¸Šã§ã€ <strong>å¼•æ•°ã‚‚æ¸¡ã›ã‚‹</strong></p></li>
</ol>
</section>
</section>
<section>
<section >
<h2>ãã‚‚ãã‚‚ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¨ã¯</h2>
<blockquote>
<div><p>åˆ¥ã®é–¢æ•°ã‚’è¿”ã™é–¢æ•°ã§ã€é€šå¸¸ã€ &#64;wrapper æ§‹æ–‡ã§é–¢æ•°å¤‰æ›ã¨ã—ã¦é©ç”¨ã•ã‚Œã¾ã™ï¼ˆ <a class="reference external" href="https://docs.python.org/ja/3/glossary.html#term-decorator">ç”¨èªé›†</a> ã‚ˆã‚Šï¼‰</p>
</div></blockquote>
<p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã§é–¢æ•°å‘¼ã³å‡ºã—ã®å‰å¾Œã« <strong>è¿½åŠ ã‚³ãƒ¼ãƒ‰</strong> ã‚’å®Ÿè¡Œã§ãã‚‹</p>
</section>
<section >
<h3>ğŸš¨ ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯é–¢æ•°ã¨ã‚¯ãƒ©ã‚¹ã«ä»˜ã‘ã‚‰ã‚Œã‚‹</h3>
<ul class="simple">
<li><p>ä»Šå› <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½œã‚ŠãŸã‹ã£ãŸ</p></li>
<li><p>ãã®ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ <strong>é–¢æ•°</strong> ã‚’ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã™ã‚‹ã®ã«ä½¿ã†</p></li>
<li><p>å®Ÿè£…ã™ã‚‹ä¸Šã§ã€çŸ¥ã£ã¦ã„ã‚‹ç¯„å›²ã‹ã‚‰ <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã‚’å‚è€ƒã«ã—ãŸ</p></li>
</ul>
</section>
<section >
<h3>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®æ›¸ãæ›ãˆï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰</h3>
<p><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®3ã¤ã®ä¾‹ã«ã¤ã„ã¦ã€ <em>ã ã„ãŸã„ç­‰ä¾¡</em> ãªæ›¸ãæ–¹ï¼ˆ <a class="reference external" href="https://docs.python.org/ja/3/reference/compound_stmts.html#class">å‚è€ƒ</a> ï¼‰</p>
<pre><code data-trim data-noescape  class="python">
&#64;dataclass  # C = dataclass(C)
class C:
    ...

&#64;dataclass()  # C = dataclass()(C)
class C:
    ...

# C = dataclass(init=True, ..., frozen=False)(C)
&#64;dataclass(init=True, repr=True, eq=True, order=False, unsafe_hash=False, frozen=False)
class C:
    ...</code></pre>
</section>
</section>
<section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã¯ã©ã†å®Ÿç¾ã—ã¦ã„ã‚‹ï¼ŸğŸ”</h2>
<ul class="simple">
<li><p>CPythonã®å®Ÿè£…ã‚’è¦‹ã¦ã¿ã¾ã™ï¼ˆv3.9.6 <span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/python/cpython/blob/db3ff76da19004f266b62e98a81bdfd322861436/Lib/dataclasses.py#L998">Lib/dataclasses.py</a> ï¼‰</p></li>
</ul>
<pre><code data-trim data-noescape data-line-numbers class="python">
def dataclass(cls=None, /, *, init=True, repr=True, eq=True, order=False,
              unsafe_hash=False, frozen=False):

    def wrap(cls):
        return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)

    if cls is None:
        return wrap

    return wrap(cls)</code></pre>
</section>
<section >
<h3><code class="file docutils literal notranslate"><span class="pre">Lib/dataclasses.py</span></code> ã® <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®å®Ÿè£… 1/4</h3>
<pre><code data-trim data-noescape data-line-numbers="1,2" class="python">
# å¼•æ•°ã« **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤** ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
def dataclass(cls=None, /, *, init=True, repr=True, eq=True, order=False,
              unsafe_hash=False, frozen=False):

    def wrap(cls):
        return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)

    if cls is None:
        return wrap

    return wrap(cls)</code></pre>
</section>
<section >
<h3><code class="file docutils literal notranslate"><span class="pre">Lib/dataclasses.py</span></code> ã® <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®å®Ÿè£… 2/4</h3>
<pre><code data-trim data-noescape data-line-numbers="5,6,7" class="python">
def dataclass(cls=None, /, *, init=True, repr=True, eq=True, order=False,
              unsafe_hash=False, frozen=False):

    def wrap(cls):
        # ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼šå¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—(dataclass)ã®å¤‰æ•°initãªã©ã‚’å‚ç…§ã€‚
        # å¤–å´ã®ã‚¹ã‚³ãƒ¼ãƒ—(dataclass)ã®å¤‰æ•°ã¯ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®å‘¼ã³å‡ºã—ã§è¨­å®šã•ã‚Œã‚‹
        return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)

    if cls is None:
        return wrap

    return wrap(cls)</code></pre>
</section>
<section >
<h3><code class="file docutils literal notranslate"><span class="pre">Lib/dataclasses.py</span></code> ã® <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®å®Ÿè£… 3/4</h3>
<pre><code data-trim data-noescape data-line-numbers="7,8,9,10" class="python">
def dataclass(cls=None, /, *, init=True, repr=True, eq=True, order=False,
              unsafe_hash=False, frozen=False):

    def wrap(cls):
        return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)

    # &#64;dataclass() ã‚„ &#64;dataclass(frozen=True) ã§ã¯ cls is None
    if cls is None:
        # C = dataclass()(C) ğŸ‘‰ C = wrap(C)
        return wrap

    return wrap(cls)</code></pre>
</section>
<section >
<h3><code class="file docutils literal notranslate"><span class="pre">Lib/dataclasses.py</span></code> ã® <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®å®Ÿè£… 4/4</h3>
<pre><code data-trim data-noescape data-line-numbers="10,11,12" class="python">
def dataclass(cls=None, /, *, init=True, repr=True, eq=True, order=False,
              unsafe_hash=False, frozen=False):

    def wrap(cls):
        return _process_class(cls, init, repr, eq, order, unsafe_hash, frozen)

    if cls is None:
        return wrap

    # &#64;dataclass ã§ã¯ cls ã¯ã€ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ç¶šã„ã¦å®šç¾©ã•ã‚Œã‚‹ã‚¯ãƒ©ã‚¹ã‚’æŒ‡ã™
    # C = dataclass(C) ğŸ‘‰ C = wrap(C) ã¨ãªã£ã¦ã„ã‚‹
    return wrap(cls)</code></pre>
</section>
</section>
<section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã‚’å‚è€ƒã«å®Ÿè£…ã—ãŸãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ <code class="docutils literal notranslate"><span class="pre">&#64;using_firefox</span></code></h2>
<p><span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/ftnext/connpass-ops-playbook/blob/fed230ef2efbd5b1c0bf03ec18da27403f75f960/examples/copy_existing_event.py">copy_existing_event.py</a></p>
<pre><code data-trim data-noescape data-line-numbers="1" class="python">
&#64;using_firefox
&#64;logged_in
def show_copy_popup(url):
    copy_existing_event(url, human_confirms=True)</code></pre>
</section>
<section >
<h3><a class="reference external" href="https://github.com/mherrmann/selenium-python-helium">Helium</a>ï¼</h3>
<ul class="simple">
<li><p><strong>ãƒ–ãƒ©ã‚¦ã‚¶æ“ä½œ</strong> ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆ2600 starï¼‰</p></li>
<li><p>Seleniumã®ãƒ©ãƒƒãƒ‘ãƒ¼ã§ã€ <strong>éå¸¸ã«ç°¡å˜</strong> ã«æ›¸ã‘ã‚‹ï¼ğŸ’«</p></li>
<li><p>è©³ã—ãã¯ <a class="reference external" href="https://pyconjp.connpass.com/event/218154/">9/11(åœŸ) #pycharity</a> ã®LTã§å…±æœ‰ã—ã¾ã™</p></li>
</ul>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;using_firefox</span></code></h3>
<ul class="simple">
<li><p>ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆFirefoxï¼‰ã‚’èµ·å‹•ã™ã‚‹å‡¦ç† <code class="docutils literal notranslate"><span class="pre">helium.start_firefox</span></code> ã¯å¿…ãšå‘¼ã¶</p></li>
<li><p>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã§å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ <strong>é–¢æ•°å‘¼ã³å‡ºã—ã®å‰ã«å¿…ãšè¿½åŠ </strong> ã§ãã‚‹ï¼ğŸ¤©</p></li>
<li><p>ã•ã‚‰ã« <code class="docutils literal notranslate"><span class="pre">&#64;using_chrome</span></code> ã¨ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’å¤‰ãˆãŸã‚‰èµ·å‹•ã™ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã‚‚å¤‰ã‚ã‚‹å®Ÿè£…ğŸ†’</p></li>
</ul>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;using_firefox(options=...)</span></code></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">helium.start_firefox</span></code> ã« <code class="docutils literal notranslate"><span class="pre">selenium.webdriver.FirefoxOptions</span></code> ã‚’æ¸¡ã—ãŸã„</p>
<ul>
<li><p>ä¾‹ï¼šãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã‚’å‡ºã•ãªã„ã‚ˆã†ã«Firefoxã‚’è¨­å®šã™ã‚‹</p></li>
</ul>
</li>
<li><p><strong>1ã¤ã®ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿</strong> <code class="docutils literal notranslate"><span class="pre">&#64;using_firefox</span></code> ã§å®Ÿç¾ã—ãŸãä»Šå›å–ã‚Šçµ„ã‚“ã </p></li>
</ul>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;using_firefox(options=...)</span></code> ã®ä¾‹</h3>
<p><span class="raw-html"><i class="fab fa-github"></i></span> <a class="reference external" href="https://github.com/ftnext/connpass-ops-playbook/blob/fed230ef2efbd5b1c0bf03ec18da27403f75f960/examples/download_participants_csv.py">download_participants_csv.py</a></p>
<pre><code data-trim data-noescape data-line-numbers="1" class="python">
&#64;using_firefox(options=options)
&#64;logged_in
def download(url):
    download_latest_participants_csv(url)</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã«ãªã‚‰ã£ã¦å®Ÿè£…</h3>
<pre><code data-trim data-noescape data-line-numbers="5" class="python">
def using_firefox(func=None, /, *, options=None):
    def middle(func):
        &#64;wraps(func)
        def wrapper(*args, **kwargs):
            start_firefox(options=options)  # é–¢æ•°å‘¼ã³å‡ºã—å‰ã«è¿½åŠ ã—ãŸã‹ã£ãŸï¼
            func(*args, **kwargs)

        return wrapper

    if func is None:
        return middle

    return middle(func)</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;using_firefox()</span></code> ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã—ãŸã¨ãï¼ˆ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ï¼‰</h3>
<pre><code data-trim data-noescape data-line-numbers="4,5,6" class="python">
def using_firefox(func=None, /, *, options=None):
    # middle ã®å®šç¾©ã¯çœç•¥

    if func is None:
        # f = using_firefox()(f) ğŸ‘‰ f = middle(f)
        return middle

    return middle(func)</code></pre>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">&#64;using_firefox</span></code> ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã—ãŸã¨ãï¼ˆ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ãªã„ã§ï¼‰</h3>
<pre><code data-trim data-noescape data-line-numbers="7,8" class="python">
def using_firefox(func=None, /, *, options=None):
    # middle ã®å®šç¾©ã¯çœç•¥

    if func is None:
        return middle

    # f = using_firefox(f) ğŸ‘‰ f = middle(f)
    return middle(func)</code></pre>
</section>
</section>
<section>
<section >
<h2>ã¾ã¨ã‚ğŸŒ¯ï¼š <code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªã€ <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ã©ã†ä½œã‚‹ï¼Ÿ</h2>
</section>
<section >
<h3>PyCon JP 2021 ãƒã‚±ãƒƒãƒˆãŠé¡˜ã„ã—ã¾ã™ğŸ¦ğŸ•ğŸ™</h3>
<p><a class="reference external" href="https://pyconjp.connpass.com/event/221241/">https://pyconjp.connpass.com/event/221241/</a></p>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä½œã‚Šæ–¹</h3>
<ul class="simple">
<li><p>ç¬¬1å¼•æ•° <code class="docutils literal notranslate"><span class="pre">func</span></code> / <code class="docutils literal notranslate"><span class="pre">cls</span></code> ã® <strong>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤</strong> ã‚’ <code class="docutils literal notranslate"><span class="pre">None</span></code> ã«ã™ã‚‹</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> / <code class="docutils literal notranslate"><span class="pre">cls</span></code> ã®å€¤ã§ <strong>åˆ†å²</strong></p></li>
</ul>
</section>
<section >
<h3><code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã¦ã‚‚ä»˜ã‘ãªãã¦ã‚‚ã„ã„ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä½œã‚Šæ–¹ï¼ˆæ‰¿å‰ï¼‰</h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> / <code class="docutils literal notranslate"><span class="pre">cls</span></code> ã®å€¤ã§åˆ†å²</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> ãªã‚‰ã€ã‚¯ãƒ©ã‚¹/é–¢æ•°ã‚’å¼•æ•°ã«å—ã‘å–ã‚‹ <strong>é–¢æ•°</strong> ã‚’è¿”ã™ï¼ˆ <code class="docutils literal notranslate"><span class="pre">()</span></code> ä»˜ãã«å¯¾å¿œï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> ã§ãªã„ãªã‚‰ã€ã‚¯ãƒ©ã‚¹/é–¢æ•°ã‚’å¼•æ•°ã«å—ã‘å–ã‚‹é–¢æ•°ã« <code class="docutils literal notranslate"><span class="pre">func</span></code> / <code class="docutils literal notranslate"><span class="pre">cls</span></code> ã‚’æ¸¡ã—ãŸ <strong>è¿”ã‚Šå€¤</strong> ã‚’è¿”ã™ï¼ˆ <code class="docutils literal notranslate"><span class="pre">()</span></code> ãªã—ã«å¯¾å¿œï¼‰</p></li>
</ul>
</li>
</ul>
</section>
<section >
<h3>ã‚¯ãƒ©ã‚¹/é–¢æ•°ã‚’å¼•æ•°ã«å—ã‘å–ã‚‹é–¢æ•°</h3>
<ul class="simple">
<li><p>å®Ÿè£…ã«ã¯ <strong>ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£</strong> ã‚’åˆ©ç”¨</p></li>
<li><p>ã“ã®é–¢æ•°ã®ä¸­ã§ã€ <strong>ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®å¼•æ•°ã‚’å‚ç…§</strong> ã—ã¦å®Ÿè£…ã™ã‚‹</p></li>
<li><p>ã‚¯ãƒ­ãƒ¼ã‚¸ãƒ£ï¼š <em>functions that refer to variables from the scope in which they were defined</em> ï¼ˆã€Effective Python second editionã€Item 21 p.84ï¼‰</p></li>
</ul>
</section>
<section >
<h3>ã”æ¸…è´ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ</h3>
<p><strong>Enjoy</strong> development with decorators!</p>
<p>Referencesã€ <strong>Appendix</strong> ãŒç¶šãã¾ã™ï¼ˆã‚ˆã‚ã—ã‘ã‚Œã°ã©ã†ãï¼ï¼‰</p>
</section>
</section>
<section >
<h2>Referencesï¼šç›´è¿‘ã®ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿é–¢é€£ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆâš¡ï¸</h2>
<iframe width="800" height="480" src="https://ftnext.github.io/2021_slides/rakus_Aug_pythontips/about_decorators.html" title="ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«ã¤ã„ã¦ï¼ˆãƒ©ã‚¯ã‚¹ Python tips LTï¼‰"></iframe></section>
<section >
<h2>Appendix</h2>
<ul class="simple">
<li><p>ä½ç½®å°‚ç”¨ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨å¼•æ•°</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®åˆ¥ã®ä¾‹</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">print</span></code> ã‚’ä»•è¾¼ã‚“ã§ <code class="docutils literal notranslate"><span class="pre">decorator()(f)</span></code> å‘¼ã³å‡ºã—é †ã‚’ç¢ºèª</p></li>
</ul>
</section>
<section>
<section >
<h2>ä½ç½®å°‚ç”¨ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨å¼•æ•°</h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">using_firefox(func=None,</span> <span class="pre">/,</span> <span class="pre">*,</span> <span class="pre">options=None):</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> ã¯ <strong>ä½ç½®å°‚ç”¨</strong> å¼•æ•°ï¼ˆğŸ™…â€â™‚ï¸ <code class="docutils literal notranslate"><span class="pre">using_firefox(func=f)</span></code>ï¼‰</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code> ã¯ <strong>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨</strong> ã€‚ <code class="docutils literal notranslate"><span class="pre">options=...</span></code> ã¨æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼ˆä½ç½®å¼•æ•°ã¨ã—ã¦æŒ‡å®šã§ããªã„ ğŸ™…â€â™‚ï¸ <code class="docutils literal notranslate"><span class="pre">using_firefox(func,</span> <span class="pre">options)</span></code>ï¼‰</p></li>
</ul>
</section>
<section >
<h3>ä½ç½®å°‚ç”¨å¼•æ•° in Pythonãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</h3>
<blockquote>
<div><p><em>ä½ç½®å°‚ç”¨</em> ã®å ´åˆã€å¼•æ•°ã®é †åºãŒé‡è¦ã§ã‚ã‚Šã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å¼•æ•°ã‚’æ¸¡ã›ã¾ã›ã‚“ã€‚ ä½ç½®å°‚ç”¨å¼•æ•°ã¯ <code class="docutils literal notranslate"><span class="pre">/</span></code> ï¼ˆã‚¹ãƒ©ãƒƒã‚·ãƒ¥ï¼‰ã®å‰ã«é…ç½®ã•ã‚Œã¾ã™ã€‚</p>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/ja/3/tutorial/controlflow.html#positional-only-parameters">https://docs.python.org/ja/3/tutorial/controlflow.html#positional-only-parameters</a></p>
</section>
<section >
<h3>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨å¼•æ•° in Pythonãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</h3>
<blockquote>
<div><p>å¼•æ•°ã‚’ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°ã§æ¸¡ã™å¿…è¦ãŒã‚ã‚‹ã“ã¨ã‚’ç¤ºã™ <em>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨</em> ã¨ã—ã¦å¼•æ•°ã‚’ãƒãƒ¼ã‚¯ã™ã‚‹ã«ã¯ã€å¼•æ•°ãƒªã‚¹ãƒˆã®æœ€åˆã® <em>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å°‚ç”¨</em> å¼•æ•°ã®ç›´å‰ã« <code class="docutils literal notranslate"><span class="pre">*</span></code> ã‚’é…ç½®ã—ã¾ã™ã€‚</p>
</div></blockquote>
<p><a class="reference external" href="https://docs.python.org/ja/3/tutorial/controlflow.html#keyword-only-arguments">https://docs.python.org/ja/3/tutorial/controlflow.html#keyword-only-arguments</a></p>
</section>
</section>
<section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">&#64;dataclass</span></code> ã®ã‚ˆã†ãªãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®åˆ¥ã®ä¾‹</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def once_per_minutes(func=None, /, *, n=1):
    def middle(func):
        last_ran_at = 0

        &#64;wraps(func)
        def wrapper(*args, **kwargs):
            nonlocal last_ran_at
            current_time = time.time()
            if current_time - last_ran_at &lt; n * 60:
                raise RunTooOftenError(
                    f&quot;Wait longer before running {func.__name__}&quot;
                )
            last_ran_at = current_time
            value = func(*args, **kwargs)
            return value

        return wrapper

    if func is None:
        return middle

    return middle(func)
</code></pre>
</section>
<section >
<h3>åˆ¥ã®ä¾‹ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</h3>
<ul class="simple">
<li><p>å¼•æ•°ã‚’å–ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä¾‹ï¼šå‘¼ã³å‡ºã—ã¯Nåˆ†ã«1å›ï¼ˆè©³ã—ãã¯Referencesã®ã‚¹ãƒ©ã‚¤ãƒ‰ã‚’ã©ã†ãï¼‰</p></li>
<li><p>ä»Šå›ã®å†…å®¹ã‚’ã‚‚ã¨ã«ã€ <strong>å¼•æ•°ã‚’å–ã‚‰ãªã„ä½¿ã„æ–¹ã‚‚ã§ãã‚‹</strong> ã‚ˆã†ã«æ‹¡å¼µã—ãŸ</p></li>
</ul>
</section>
<section >
<h3>åˆ¥ã®ä¾‹ã‚’å®Ÿè¡Œ</h3>
<aside class="notes">
doctest ã‚’é€šã™ï¼ˆãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯é™¤ã„ãŸå®Ÿè£…ï¼‰
&gt;&gt;&gt; def calculate_bmi(height_m, weight_kg):
...     return weight_kg / height_m / height_m
&gt;&gt;&gt; calculate_bmi1 = calculate_bmi2 = calculate_bmi3 = calculate_bmi</aside>
<p>å®Ÿè¡Œç’°å¢ƒ Python 3.9.4</p>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; calculate_bmi1(1.58, 46)
18.426534209261334
&gt;&gt;&gt; # calculate_bmi1(1.58, 46)  # Raise RunTooOftenError
&gt;&gt;&gt; calculate_bmi2(1.58, 46)
18.426534209261334
&gt;&gt;&gt; # calculate_bmi2(1.58, 46)  # Raise RunTooOftenError
&gt;&gt;&gt; calculate_bmi3(1.58, 46)
18.426534209261334
&gt;&gt;&gt; calculate_bmi3(1.58, 46)
18.426534209261334</code></pre>
</section>
</section>
<section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">print</span></code> ã‚’ä»•è¾¼ã‚“ã§ <code class="docutils literal notranslate"><span class="pre">decorator()(f)</span></code> å‘¼ã³å‡ºã—é †ã‚’ç¢ºèª</h2>
<pre><code data-trim data-noescape data-line-numbers class="python">
def decorator(func=None, /, *, n=1):
    print(f&quot;decorator start: {func=} {n=}&quot;)

    def middle(func):
        print(&quot;middle start&quot;)

        def wrapper(*args, **kwargs):
            print(f&quot;wrapper start: {args=}, {kwargs=}&quot;)
            func(*args, **kwargs)
            print(&quot;wrapper end&quot;)

        print(&quot;middle end&quot;)
        return wrapper

    print(&quot;decorator end&quot;)
    if func is None:
        return middle

    return middle(func)
</code></pre>
</section>
<section >
<h3>(1) <code class="docutils literal notranslate"><span class="pre">()</span></code> ãªã—ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆ</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; &#64;decorator  
... def f1(): ...
...
decorator start: func=&lt;function f1 at 0x1092a9a60&gt; n=1  # funcã«f1ãŒæ¸¡ã£ã¦ã„ã‚‹
decorator end
middle start  # middle(func) ã‚’è¿”ã—ãŸã“ã¨ã«ã‚ˆã‚‹å®Ÿè¡Œ
middle end</code></pre>
</section>
<section >
<h3>(2) <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆ</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; &#64;decorator()  
... def f2(): ...
...
decorator start: func=None n=1
decorator end
middle start  # f2 = middle(f2) éƒ¨åˆ†
middle end</code></pre>
</section>
<section >
<h3>å¯„ã‚Šé“ï¼š <code class="docutils literal notranslate"><span class="pre">middle</span></code> ãŒè¿”ã£ã¦ã„ã‚‹ 1/2</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; decorator()  
decorator start: func=None n=1
decorator end
&lt;function decorator.&lt;locals&gt;.middle at 0x1092ba280&gt;  # decorator() ã®è¿”ã‚Šå€¤</code></pre>
</section>
<section >
<h3>å¯„ã‚Šé“ï¼š <code class="docutils literal notranslate"><span class="pre">middle</span></code> ãŒè¿”ã£ã¦ã„ã‚‹ 2/2</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; def f(): ...
...
&gt;&gt;&gt; decorator()(f)  
decorator start: func=None n=1
decorator end
middle start
middle end
&lt;function decorator.&lt;locals&gt;.middle.&lt;locals&gt;.wrapper at 0x1092ba430&gt;
&gt;&gt;&gt; f2  # decorator()(f) ã¨åŒæ§˜ã« wrapper  
&lt;function decorator.&lt;locals&gt;.middle.&lt;locals&gt;.wrapper at 0x1092ba550&gt;</code></pre>
</section>
<section >
<h3>(3) <code class="docutils literal notranslate"><span class="pre">()</span></code> ã‚’ä»˜ã‘ã€å€¤ã‚‚æŒ‡å®šã—ã¦ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆ</h3>
<pre><code data-trim data-noescape  class="python">
&gt;&gt;&gt; &#64;decorator(n=3)  
... def f3(): ...
...
decorator start: func=None n=3  # nã¯æ¸¡ã—ãŸå€¤
decorator end
middle start
middle end</code></pre>
</section>
</section>
<section >
<h2><code class="docutils literal notranslate"><span class="pre">print</span></code> ã§ç¢ºèªã—ãŸå‘¼ã³å‡ºã—é †</h2>
<ul class="simple">
<li><p>(1)~(3)ã®3ä¾‹ã¨ã‚‚ <strong>å‡ºåŠ›ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯åŒæ§˜</strong></p></li>
<li><p>ã¤ã¾ã‚Š <code class="docutils literal notranslate"><span class="pre">()</span></code> ã®æœ‰ç„¡ã«ã‚ˆã‚‰ãšã€é–¢æ•°ãŒãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹</p></li>
<li><p>åˆ†å²ã®å®Ÿè£…ã«ã‚ˆã‚Š <code class="docutils literal notranslate"><span class="pre">()</span></code> ã®æœ‰ç„¡ã«ã‚ˆã‚‰ãšã€é–¢æ•°ãŒãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã•ã‚Œã‚‹</p></li>
</ul>
</section>
<section >
<h2>EOF</h2>
</section>

        </div>
    </div>
    
    <script src="../reveal.js/dist/reveal.js"></script>
    
    
      <script src="../reveal.js/plugin/highlight/highlight.js"></script>
      
    
    <script>
        var revealjsConfig = new Object();
        Object.assign(revealjsConfig, 
    {
        controls: true,
        progress: true,
        history: true,
        center: true,
        transition: "none",
        slideNumber: "c/t",
    }
);
        
        
        
          revealjsConfig.plugins = [
            RevealHighlight,
          ];
        
        // More info https://github.com/hakimel/reveal.js#configuration
        Reveal.initialize(revealjsConfig);
    </script>

  </body>
</html>
