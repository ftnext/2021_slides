.. role:: raw-html(raw)
    :format: html

========================================================================================================================
Pythonと一緒に！　好きなアニメ映画のファン活動
========================================================================================================================

:Event: PyCon mini Shizuoka 2021
:Presented: 2021/11/20 nikkie

皆さん、本物のnikkieですよ
============================================================

※変なテンションで「お前、誰よ」（自己紹介）をお送りします

PyCon JP 2021でお会いして以来ですね
------------------------------------------------

PyCon JP 2021 座長でした。ご参加ありがとうございました

.. raw:: html

   </section>
   <section >

.. raw:: html

   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">PyCon JP 2021 Advent Calendar、やりますよーー！！（参加者募集中🙏）: <a href="https://twitter.com/hashtag/pyconjp?src=hash&amp;ref_src=twsrc%5Etfw">#pyconjp</a> 皆さん、こんにちは。 PyCon JP 2021 座長のnikkieです。 今回はPyCon JP 2021… <a href="https://t.co/kD37moCApr">https://t.co/kD37moCApr</a></p>&mdash; PyCon JP (@pyconjapan) <a href="https://twitter.com/pyconjapan/status/1457928695679578114?ref_src=twsrc%5Etfw">November 9, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

📣 PyCon JP 2021 Advent Calendar、やります！
------------------------------------------------

* https://qiita.com/advent-calendar/2021/pyconjp
* PyCon JP 2021にちなんだアウトプット募集中
* **小さなアウトプット大歓迎**。チケット買ってなくても、資料やアーカイブ見て参加して大丈夫です！

お前、誰よ
------------------------------------------------

* ``@pytest.mark.skip("スライドだけを確認する方向けのスライド")``
* Python大好き **にっきー** （:raw-html:`<i class="fab fa-twitter"></i>` `@ftnext <https://twitter.com/ftnext>`_ / :raw-html:`<i class="fab fa-github"></i>` `@ftnext <https://github.com/ftnext>`_）
* Python歴4年。株式会社ユーザベースのデータサイエンティスト（NLPer）

PyCon JP 2021の会期を終えたnikkie
============================================================

『アイの歌声を聴かせて』にハマりました
------------------------------------------------

.. raw:: html
   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">アイの歌声を聴かせて、めっちゃよかったです👏<br><br>予告で聞いた「秘密はね、最後に明かされるんだよ」という言の通りで、AIに関わっている立場からはいいなと思わされる希望のフィルムでした<br><br>叶わないですが記憶消して何周もしたいです。<br>今後スタッフトークショー楽しみ！<a href="https://t.co/WsA2nv6TY6">https://t.co/WsA2nv6TY6</a></p>&mdash; nikkie 📣PyCon JP 2021 ありがとうございました (@ftnext) <a href="https://twitter.com/ftnext/status/1454373641496367108?ref_src=twsrc%5Etfw">October 30, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

TODO：『アイの歌声を聴かせて』ロングPVはYouTubeで見られます！！
------------------------------------------------------------------------------------------------

.. raw:: html
   <iframe width="560" height="315" src="https://www.youtube.com/embed/58q1s6B8lCM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

連日 #アイの歌声を聴かせて でTLをお騒がせしています😉
------------------------------------------------------------------------------------------------

.. raw:: html
   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">アイの歌声を聴かせてにどハマりしちゃったんですが、これは座長業などの締切に追われていないこの時期だからこそできるんですよね。<br>観た方とTwitterでいいよねーって語れるのがもう最高で<br><br>こういう、今を楽しめるって幸せもあるんだなあ（これまでが不幸せだったと思ってるわけじゃないですよ。為念</p>&mdash; nikkie 📣PyCon JP 2021 ありがとうございました (@ftnext) <a href="https://twitter.com/ftnext/status/1458818025289764867?ref_src=twsrc%5Etfw">November 11, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

LT：Pythonと一緒に！　好きなアニメ映画のファン活動
------------------------------------------------------------------------------------------------

.. raw:: html
   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr"><a href="https://twitter.com/hashtag/%E3%82%A2%E3%82%A4%E3%81%AE%E6%AD%8C%E5%A3%B0%E3%82%92%E8%81%B4%E3%81%8B%E3%81%9B%E3%81%A6?src=hash&amp;ref_src=twsrc%5Etfw">#アイの歌声を聴かせて</a> 私にできる応援ということでプログラミングと絡めます。<br>先日のスタッフトーク音楽篇で1曲め「ユー・ニード・ア・フレンド」には「友達」という語が頻出とのこと。<br>パンフレット収録の歌詞には6回出てきてました。<br><br>ではここで問題（たたーん♪）、友達の次に出てくる語は？</p>&mdash; nikkie 📣PyCon JP 2021 ありがとうございました (@ftnext) <a href="https://twitter.com/ftnext/status/1458106396637949952?ref_src=twsrc%5Etfw">November 9, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

お品書き：Pythonと一緒に！　好きなアニメ映画のファン活動
------------------------------------------------------------------------------------------------

1. 公開から何日目？
2. 劇中のシーンを再現（目覚まし）
3. 劇中歌の歌詞分析

Pythonと一緒に！　好きなアニメ映画のファン活動
------------------------------------------------------------------------------------------------

1. **公開から何日目？**
2. 劇中のシーンを再現（目覚まし）
3. 劇中歌の歌詞分析

1.公開から何日目？
============================================================

デモします

.. code-block:: shell

    $ python3.10 x-days-anniversary/main.py
    『アイの歌声を聴かせて』公開から23日目です

公開から何日目？の実装
------------------------------------------------------------------------------------------------

.. code-block:: python

    >>> from datetime import date
    >>> AINOUTA_DAY = date(2021, 10, 29)
    >>> date.today() - AINOUTA_DAY
    datetime.timedelta(days=22)
    >>> (date.today() - AINOUTA_DAY).days + 1  # 10/29を1日目とする
    23

9月の #pycharity でのHayaoさんのLTにインスパイアされました！
------------------------------------------------------------------------------------------------

.. raw:: html
   <iframe class="speakerdeck-iframe" style="border: 0px none; background: rgba(0, 0, 0, 0.1) none repeat scroll 0% 0% padding-box; margin: 0px; padding: 0px; border-radius: 6px; box-shadow: rgba(0, 0, 0, 0.2) 0px 5px 40px; width: 560px; height: 314px;" src="https://speakerdeck.com/player/e077f158437f423294d2600076abc3b4?slide=8" title="Python for Everyday" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true" data-ratio="1.78343949044586" frameborder="0"></iframe>

Pythonと一緒に！　好きなアニメ映画のファン活動
------------------------------------------------------------------------------------------------

1. 公開から何日目？
2. **劇中のシーンを再現（目覚まし）**
3. 劇中歌の歌詞分析

2.劇中のシーンを再現（目覚まし）
============================================================

.. raw:: html
   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr"><a href="https://twitter.com/hashtag/%E3%82%A2%E3%82%A4%E3%81%AE%E6%AD%8C%E5%A3%B0%E3%82%92%E8%81%B4%E3%81%8B%E3%81%9B%E3%81%A6?src=hash&amp;ref_src=twsrc%5Etfw">#アイの歌声を聴かせて</a> <br>気付いてしまいましたよ、<a href="https://t.co/5KHa4xqMzt">https://t.co/5KHa4xqMzt</a> を決まった時間に流せれば、サトミとお揃い！<br>ちょっと実装試みてみます<br>（もしかしてトウマ先生、実装済みだったりする？）</p>&mdash; nikkie 📣PyCon JP 2021 ありがとうございました (@ftnext) <a href="https://twitter.com/ftnext/status/1459531260938776581?ref_src=twsrc%5Etfw">November 13, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

目覚ましの曲「フィール ザ ムーンライト ～愛の歌声を聴かせて～」
------------------------------------------------------------------------------------------------

.. raw:: html
   <iframe width="560" height="315" src="https://www.youtube.com/embed/BVJhS-cXhOc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

💡ひらめいたnikkie（アニメ脳）
------------------------------------------------------------------------------------------------

* 目覚ましの曲はYouTubeで流せる
* 指定した時間に目覚ましの曲を流す＝目覚ましのシーン再現！
* 要は「YouTubeの動画を自動で流す」を実装

デモ 🤖🎤🎼
------------------------------------------------------------------------------------------------

.. code-block:: shell

    # 『アイの歌声を聴かせて』の目覚ましを2分後にかけるコマンド
    $ python after_x_minutes.py 2

JavaScriptでYouTubeを自動再生
------------------------------------------------------------------------------------------------

.. code-block:: javascript
    :caption: autoplay.html

    var player;
    function onYouTubeIframeAPIReady() {
      player = new YT.Player("player", {
        height: "315",
        width: "560",
        videoId: "BVJhS-cXhOc",
        events: {
        onReady: onPlayerReady,
        onStateChange: onPlayerStateChange,
        },
      });
    }

``webbrowser`` でHTMLを開けば、自動再生始まる
------------------------------------------------------------------------------------------------

.. code-block:: shell

    $ python3 -m webbrowser -t "autoplay.html"
    # 先のデモスクリプトでは webbrowser.open_new_tab を呼んでいます

https://docs.python.org/ja/3/library/webbrowser.html

Pythonと一緒に！　好きなアニメ映画のファン活動
------------------------------------------------------------------------------------------------

1. 公開から何日目？
2. 劇中のシーンを再現（目覚まし）
3. **劇中歌の歌詞分析**

3.劇中歌の歌詞分析
============================================================

.. raw:: html
   <blockquote class="twitter-tweet"><p lang="ja" dir="ltr">数え方にもよるかもしれませんが、「欲しい」でした。<br>友達欲しいって連呼する曲なだけありますね<br><br>ちなみに1回以上は<br>[(&#39;友達&#39;, 6), (&#39;欲しい&#39;, 3), (&#39;幸せ&#39;, 2), (&#39;ひとりぼっち&#39;, 2), (&#39;歌う&#39;, 2)]<br>といったラインナップで、ここを見るだけでも曲の意図が伝わってきますね <a href="https://twitter.com/hashtag/%E3%82%A2%E3%82%A4%E3%81%AE%E6%AD%8C%E5%A3%B0%E3%82%92%E8%81%B4%E3%81%8B%E3%81%9B%E3%81%A6?src=hash&amp;ref_src=twsrc%5Etfw">#アイの歌声を聴かせて</a></p>&mdash; nikkie 📣PyCon JP 2021 ありがとうございました (@ftnext) <a href="https://twitter.com/ftnext/status/1458106930623250439?ref_src=twsrc%5Etfw">November 9, 2021</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

『アイの歌声を聴かせて』はミュージカルものでもある
------------------------------------------------------------------------------------------------

* 歌でありセリフでもある
* 作詞のこだわりを聞き、歌詞の **単語を数えて** みました
* spaCyの素振りも兼ねてます（都合により2系 ``2.3.7`` です）

「ユー・ニード・ア・フレンド」
------------------------------------------------------------------------------------------------

.. raw:: html
   <iframe width="560" height="315" src="https://www.youtube.com/embed/sEvbda8vkzg?start=29" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

「ユー・ニード・ア・フレンド」で2回以上出てくる語
------------------------------------------------------------------------------------------------

.. code-block:: shell

    $ python word_counter.py you_need_a_friend.txt
    友達 [6]  # 友達友達と連呼する曲です
    欲しい [3]
    幸せ [2]
    ひとりぼっち [2]
    歌う [2]

対になる「You've Got Friends」
------------------------------------------------------------------------------------------------

.. raw:: html
   <iframe width="560" height="315" src="https://www.youtube.com/embed/Ht8oqfSgf8w?start=66" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

「You've Got Friends」で2回以上出てくる語
------------------------------------------------------------------------------------------------

.. code-block:: shell

    $ python word_counter.py youve_got_friends.txt
    あなた [3]
    光 [3]
    幸せ [2]
    月 [2]  # 月や光に関連する語が多い曲です
    照らす [2]
    明かり [2]
    誰 [2]
    空 [2]
    友達 [2]

spaCyで日本語テキストを形態素解析
------------------------------------------------------------------------------------------------

.. code-block:: python

    >>> # pip install 'spacy[ja]<3'
    >>> from spacy.lang.ja import Japanese
    >>> nlp = Japanese()
    >>> doc = nlp("あなたには友達が要る")
    >>> for token in doc:
    ...   print(token.lemma_)  # 辞書の見出し語
    ...
    あなた
    に
    は
    友達
    が
    要る

カウントしたい語の絞り込み
------------------------------------------------------------------------------------------------

.. code-block:: python

    >>> EXCLUDED_POS_SET = set(["ADP"])  # に、は、が などの助詞を除く
    >>> for token in doc:
    ...   # こと、するなど日本語のstop wordsは is_stop=True になることを使って除く
    ...   if token.pos_ not in EXCLUDED_POS_SET and not token.is_stop:
    ...     print(token.lemma_)
    ...
    あなた
    友達
    要る

実装イメージ
------------------------------------------------------------------------------------------------

* 先の2スライドのコードを使って、歌詞から語を取り出す
* ``collections.Counter`` を使って計数し、 ``most_common`` で登場回数順にする

  * https://docs.python.org/ja/3/library/collections.html#collections.Counter.most_common

まとめ🌯：Pythonと一緒に！　好きなアニメ映画のファン活動
========================================================================================================================

* 『アイの歌声を聴かせて』はいいぞ！
* 好きな作品を題材にPythonを使った3例を紹介しました

あなたの好きなもの × Python
------------------------------------------------

* 示した例自体は再利用できなくても、裏の考え方は再利用できるかも
* 「自分も **やってみたい**」「**参考** にしてこういうことができるかも」の気持ちを大切に
* このLTが手を動かすきっかけやアウトプットのきっかけになったら嬉しいです✌️

ご清聴ありがとうございました
------------------------------------------------

Happy hacking👋
