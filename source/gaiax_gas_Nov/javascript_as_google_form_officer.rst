.. role:: raw-html(raw)
    :format: html

========================================================================================================================
私のアツいPyCon JP 2021スタッフ活動＝GAS活！
========================================================================================================================

:Event: Google Apps Script 活用ミートアップ #8
:Presented: 2021/11/22 nikkie

私のアツいPyCon JP 2021スタッフ活動＝GAS活！（フォームの回答通知）
========================================================================================================================

お前、誰よ（≒自己紹介）
============================================================

* Python大好き **にっきー** （:raw-html:`<i class="fab fa-twitter"></i>` `@ftnext <https://twitter.com/ftnext>`_ / :raw-html:`<i class="fab fa-github"></i>` `@ftnext <https://github.com/ftnext>`_）
* Python歴4年。株式会社ユーザベースのデータサイエンティスト（NLPer）
* アニメも大好き。『アイの歌声を聴かせて』はいいぞ！🤖🎤🎼

お前、誰よ
------------------------------------------------

* 10/15, 16開催の **Py** thon **Con** ference JP 2021の座長🇨🇭でした
* ＝PyCon JP 2021の開催に責任を持つ人

「繰り返すタスクはPythonにやらせよう」
------------------------------------------------

* 自分が繰り返しているタスクを **自動化** してきました

  * 決まった期間、Slackで繰り返し投稿
  * Googleフォームに回答があったことの確認

このLTでは
------------------------------------------------

* 「Googleフォームの回答を通知」という要件の実装について話します
* PyCon JP 2020のスタッフ活動の中で、Pythonで実装しました
* 2021年の活動の中で、 **GASでの実装に切り替え** ました

私のアツいPyCon JP 2021スタッフ活動＝GAS活！、始まります！
------------------------------------------------------------------------------------------------

* 要件「Googleフォームの回答を通知」
* Pythonで通知を実装
* GASで通知を実装

要件「Googleフォームの回答を通知」
============================================================

Googleフォームをheavy use
------------------------------------------------

* スタッフ応募、スポンサー応募、レビュアー応募など、至るところでGoogleフォームを使う
* フォームからスプレッドシートに連携する機能もよく使う
* Confluence `Google Documents(Slides/Sheets/Docs...) <https://pyconjp.atlassian.net/l/c/X1NXf2Ex>`_

通知先はどこに？ PyCon JP Slackに！
------------------------------------------------

* スタッフ用のSlack workspaceがある

  * Confluence `Slack <https://pyconjp.atlassian.net/l/c/rN1T8k7P>`_

* 通知にはIncoming Webhookを使う

例：スタッフ応募フォームに回答があったことをSlack通知したい
------------------------------------------------------------------------------------------------

TODO：通知している画像（モザイク入れる）

私のアツいPyCon JP 2021スタッフ活動＝GAS活！、話し始めてます！
------------------------------------------------------------------------------------------------

* 要件「Googleフォームの回答を通知」
* **Pythonで通知を実装**
* GASで通知を実装

Pythonで通知を実装
============================================================

* フォームと連携した **スプレッドシート** を読み取って通知する
* この処理を定期的に動かす

詳しくはPyCon JP 2020で話しています
------------------------------------------------

.. raw:: html

    <iframe width="560" height="315" src="https://www.youtube.com/embed/VBeJU9o9API?start=225" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

`スタッフとしてコードを書こう！〜Code for PyCon JP and yourself〜 <https://pycon.jp/2020/timetable/?id=203919>`_

フォームと連携したスプレッドシート
------------------------------------------------

* その行について通知済みか否かを記録するための列を追加
* ライブラリ ``gspread`` で読み書きする

.. SlackのIncoming Webhookにはurllib

定期実行
------------------------------------------------

* スプレッドシートを読み取り、通知するスクリプトを **AWS Lambda** の関数に移植
* **Amazon CloudWatch Events** でLambda関数を定期的に実行する（例：半日に1回）

Pythonによる実装の総括
------------------------------------------------

* Slackを見ているだけでGoogleフォームの応募に気付けるようになった🙌
* 伸びしろは **即時性** （リアルタイムでない）

  * 半日に1回起動する設定なので、通知が最大で半日程度遅れる

私のアツいPyCon JP 2021スタッフ活動＝GAS活！、話し始めてます！
------------------------------------------------------------------------------------------------

* 要件「Googleフォームの回答を通知」
* Pythonで通知を実装
* **GASで通知を実装**
