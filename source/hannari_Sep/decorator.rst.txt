1ï¸âƒ£ ç¹°ã‚Šè¿”ã—æ›¸ãã‚³ãƒ¼ãƒ‰ãŒã‚ã‚‹
============================================================

Heliumã‚’ä½¿ã†ä¸­ã§æ„Ÿã˜ãŸğŸ˜– 1ç‚¹ç›®

ä¾‹ï¼šHeliumã®ãƒªãƒã‚¸ãƒˆãƒªã‚’Googleæ¤œç´¢ã—ã¦ç§»å‹•
------------------------------------------------

.. code-block:: python
    :linenos:

    start_firefox()
    go_to("google.com")
    write("helium selenium github")
    press(ENTER)
    click("Selenium-python but lighter: Helium - GitHub")

ä¾‹ï¼šconnpassã«ãƒ­ã‚°ã‚¤ãƒ³
------------------------------------------------

.. code-block:: python
    :linenos:

    start_firefox()
    go_to("connpass.com/login")
    write(os.getenv("CONNPASS_USERNAME"), into="ãƒ¦ãƒ¼ã‚¶ãƒ¼å")
    write(os.getenv("CONNPASS_PASSWORD"), into="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰")
    click("ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹")

    wait_until(Text("ã‚ãªãŸã®ã‚¤ãƒ™ãƒ³ãƒˆ").exists)

ç¹°ã‚Šè¿”ã—æ›¸ã ``start_firefox``
------------------------------------------------

.. code-block:: python
    :emphasize-lines: 1
    :linenos:

    start_firefox()
    go_to("connpass.com/login")
    write(os.getenv("CONNPASS_USERNAME"), into="ãƒ¦ãƒ¼ã‚¶ãƒ¼å")
    write(os.getenv("CONNPASS_PASSWORD"), into="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰")
    click("ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹")

    wait_until(Text("ã‚ãªãŸã®ã‚¤ãƒ™ãƒ³ãƒˆ").exists)

``start_firefox`` ã‚’ç¹°ã‚Šè¿”ã—æ›¸ãã®ã‚’ãªãã—ãŸã„
------------------------------------------------------------------------------------------------

* ``start_firefox`` ã§Firefoxã‚’ç«‹ã¡ä¸Šã’ã¦ã„ã‚‹
* ğŸ‘‰ **ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿**

ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¨ã¯ï¼ˆã–ã£ãã‚Šï¼‰
============================================================

* é–¢æ•°ã‚„ã‚¯ãƒ©ã‚¹ã®å®šç¾©ã®ç›´å‰ã« ``@`` ã§ä»˜ã‘ã‚‹ã‚ã‚Œ

.. code-block:: python

    @decorator
    def function():
        ...

ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¨ã¯
------------------------------------------------

* é–¢æ•°ã‚’å¼•æ•°ã«å–ã‚Šã€é–¢æ•°ã‚’è¿”ã™ **é–¢æ•°** ï¼ˆ `ç”¨èªé›† <https://docs.python.org/ja/3/glossary.html#term-decorator>`_ ï¼‰
* æ¸¡ã•ã‚ŒãŸé–¢æ•°ã®å‰å¾Œã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã§ãã‚‹ï¼ˆref:ã€Effective Python ç¬¬2ç‰ˆã€é …ç›®26ï¼‰

ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®å®Ÿè£…
============================================================

.. code-block:: python
    :linenos:

    def decorator(function):  # å¼•æ•°ã«é–¢æ•°
        def wrapper(*args, **kwargs):
            # functionã®å‰ã«å®Ÿè¡Œã™ã‚‹å‡¦ç†
            function(*args, **kwargs)
            # functionã®å¾Œã«å®Ÿè¡Œã™ã‚‹å‡¦ç†
        
        return wrapper  # ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ãŸé–¢æ•°ã‚’è¿”ã™

ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®ä¾‹ï¼šé–¢æ•°ã®é–‹å§‹ã¨çµ‚äº†ã‚’ç¤ºã™
------------------------------------------------

.. code-block:: python
    :linenos:

    def show_start_end(func):
        @functools.wraps(func)  # funcã®__name__ã‚„__doc__ã‚’æ®‹ã™ãŸã‚ã«ä»˜ã‘ã‚‹
        def wrapper(*args, **kwargs):
            print(func.__name__, "Start")
            returned = func(*args, **kwargs)
            print(func.__name__, "End")
            return returned
        return wrapper

é–¢æ•°ã®é–‹å§‹ã¨çµ‚äº†ã‚’ç¤ºã™ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’ä½¿ã†
------------------------------------------------

.. code-block:: python
    :linenos:

    @show_start_end
    def calculate_bmi(height_m, weight_kg):
        return weight_kg / height_m / height_m

.. code-block:: python

    >>> calculate_bmi(1.58, 46)
    calculate_bmi Start
    calculate_bmi End
    18.426534209261334

âœ… é–¢æ•°ã®å®Ÿè¡Œå‰ã« ``start_firefox`` ã‚’å‘¼ã³å‡ºã™ã‚³ãƒ¼ãƒ‰
------------------------------------------------------------------------------------------------

.. literalinclude:: ../../samplecode/cool_helium/decorator_examples.py
    :language: python
    :pyobject: using_firefox
    :linenos:

``@using_firefox`` ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã™ã‚Œã°ã€``start_firefox`` ã¯ä¸è¦
------------------------------------------------------------------------------------------------

.. literalinclude:: ../../samplecode/cool_helium/decorator_examples.py
    :language: python
    :pyobject: search_helium_repository
    :linenos:

``@using_firefox`` ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã™ã‚Œã°ã€``start_firefox`` ã¯ä¸è¦ï¼ˆãã®2ï¼‰
------------------------------------------------------------------------------------------------

.. literalinclude:: ../../samplecode/cool_helium/decorator_examples.py
    :language: python
    :pyobject: login_connpass
    :linenos:

ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã®åŠ¹èƒ½
============================================================

* ç¹°ã‚Šè¿”ã—ãŒãªããªã£ãŸï¼ğŸ™Œ
* Firefoxã ã‘ã§ãªãChromeã§ã‚‚å‹•ã‹ã—ãŸã„å ´åˆã€ **ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã‚’æ›¸ãæ›ãˆã‚‹ã ã‘** ã§æ¸ˆã‚€ï¼ï¼

Chromeã§å‹•ãã¾ã™
------------------------------------------------

.. code-block:: python
    :emphasize-lines: 1
    :linenos:

    @using_chrome  # start_chromeã‚’å‘¼ã³å‡ºã™ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿
    def login_connpass():
        go_to("connpass.com/login")
        write(os.getenv("CONNPASS_USERNAME"), into="ãƒ¦ãƒ¼ã‚¶ãƒ¼å")
        write(os.getenv("CONNPASS_PASSWORD"), into="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰")
        click("ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹")

        wait_until(Text("ã‚ãªãŸã®ã‚¤ãƒ™ãƒ³ãƒˆ").exists)
